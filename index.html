<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GOTO AI Support</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #00A599; /* GOTOã®ãƒ–ãƒ©ãƒ³ãƒ‰ã‚«ãƒ©ãƒ¼ï¼ˆç·‘ç³»ï¼‰ */
            --primary-light: #E6F7F6;
            --secondary-color: #6c757d;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
            --border-radius: 16px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fb;
            color: #333;
            line-height: 1.6;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        /* è¨€èªé¸æŠç”»é¢ */
        .language-select-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
        }
        
        .language-select-screen h1 {
            font-size: 32px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .language-select-screen p {
            color: var(--secondary-color);
            font-size: 16px;
            margin-bottom: 30px;
            max-width: 600px;
        }
        
        .language-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            max-width: 500px;
            width: 100%;
        }
        
        .language-card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .language-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }
        
        .language-card .flag {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .language-card h3 {
            font-size: 18px;
            margin-bottom: 5px;
        }
        
        .language-card p {
            font-size: 14px;
            color: var(--secondary-color);
            margin: 0;
        }
        
        /* æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ç”»é¢ */
        .info-form-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            text-align: center;
        }
        
        .info-form-screen h1 {
            font-size: 28px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .info-form-screen p {
            color: var(--secondary-color);
            font-size: 16px;
            margin-bottom: 30px;
            max-width: 600px;
        }
        
        .info-form {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            width: 100%;
            max-width: 500px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-color);
        }
        
        .form-group input, 
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #e1e4e8;
            border-radius: 8px;
            font-size: 15px;
            transition: var(--transition);
        }
        
        .form-group input:focus, 
        .form-group textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 165, 153, 0.2);
            outline: none;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .submit-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 500;
            width: 100%;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .submit-btn:hover {
            background-color: #008c82;
            transform: translateY(-2px);
        }
        
        .submit-btn:active {
            transform: translateY(0);
        }
        
        /* ãƒãƒ£ãƒƒãƒˆç”»é¢ */
        .chat-screen {
            display: none;
            flex-direction: column;
            height: 100%;
        }
        
        .chat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-bottom: 20px;
            border-bottom: 1px solid #e1e4e8;
            margin-bottom: 20px;
        }
        
        .chat-header h1 {
            font-size: 24px;
            color: var(--primary-color);
        }
        
        .language-selector {
            display: flex;
            gap: 10px;
        }
        
        .language-btn {
            padding: 8px 12px;
            background-color: white;
            color: var(--dark-color);
            border: 1px solid #e1e4e8;
            border-radius: 30px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .language-btn:hover {
            background-color: #f8f9fa;
            transform: translateY(-2px);
        }
        
        .language-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .chat-container {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 20px;
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            scroll-behavior: smooth;
        }
        
        .messages-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .message {
            display: flex;
            max-width: 85%;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            flex-shrink: 0;
        }
        
        .user-avatar {
            background-color: var(--primary-light);
            color: var(--primary-color);
        }
        
        .bot-avatar {
            background-color: var(--primary-color);
            color: white;
        }
        
        .message-content {
            padding: 12px 16px;
            border-radius: 18px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: relative;
            font-size: 15px;
            line-height: 1.5;
        }
        
        .user-message {
            margin-left: auto;
        }
        
        .user-message .message-content {
            background-color: var(--primary-color);
            color: white;
            border-bottom-right-radius: 4px;
        }
        
        .bot-message .message-content {
            background-color: #f0f2f5;
            color: var(--dark-color);
            border-bottom-left-radius: 4px;
        }
        
        .typing-indicator {
            display: flex;
            padding: 12px 16px;
            background-color: #f0f2f5;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
            width: fit-content;
        }
        
        .typing-indicator span {
            height: 8px;
            width: 8px;
            background-color: #93a0b5;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
            animation: typing 1.4s infinite both;
        }
        
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
            margin-right: 0;
        }
        
        @keyframes typing {
            0% {
                transform: translateY(0px);
                background-color: #93a0b5;
            }
            28% {
                transform: translateY(-7px);
                background-color: #5d6c84;
            }
            44% {
                transform: translateY(0px);
                background-color: #93a0b5;
            }
        }
        
        /* æ–°è¦è¿½åŠ : ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ææ¡ˆ */
        .message-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
        }
        
        .suggestion-chip {
            background-color: white;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            border-radius: 20px;
            padding: 8px 15px;
            font-size: 14px;
            cursor: pointer;
            transition: var(--transition);
            white-space: nowrap;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .suggestion-chip:hover {
            background-color: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .input-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            position: relative;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 15px;
        }
        
        .input-field-container {
            display: flex;
            gap: 10px;
        }
        
        #user-input {
            flex-grow: 1;
            padding: 12px 15px;
            border: 1px solid #e1e4e8;
            border-radius: 24px;
            font-size: 15px;
            outline: none;
            transition: var(--transition);
        }
        
        #user-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 165, 153, 0.2);
        }
        
        .send-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 2px 5px rgba(0, 165, 153, 0.3);
        }
        
        .send-btn:hover {
            background-color: #008c82;
            transform: translateY(-2px);
        }
        
        .send-btn:active {
            transform: translateY(0);
        }
        
        .send-btn i {
            font-size: 18px;
        }
        
        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .language-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .chat-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .language-selector {
                width: 100%;
                justify-content: space-between;
            }
            
            .language-btn {
                font-size: 12px;
                padding: 6px 10px;
            }
            
            .message {
                max-width: 90%;
            }
            
            .info-form {
                padding: 20px;
            }
            
            .message-suggestions {
                overflow-x: auto;
                padding-bottom: 5px;
                flex-wrap: nowrap;
            }
        }
        
        @media (min-width: 769px) and (max-width: 1024px) {
            .container {
                padding: 20px;
            }
        }
        
        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã‚µãƒãƒ¼ãƒˆ */
        @media (prefers-color-scheme: dark) {
            body {
                background-color: #1a1d21;
                color: #e1e4e8;
            }
            
            .language-card, .info-form, .chat-container, .input-container {
                background-color: #252a31;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            }
            
            .chat-header {
                border-bottom-color: #2d333b;
            }
            
            .language-btn {
                background-color: #252a31;
                color: #e1e4e8;
                border-color: #2d333b;
            }
            
            .language-btn:hover {
                background-color: #2d333b;
            }
            
            .language-card p, .chat-header p, .info-form-screen p {
                color: #a0a8b1;
            }
            
            .form-group label {
                color: #e1e4e8;
            }
            
            .form-group input, .form-group textarea {
                background-color: #2d333b;
                color: #e1e4e8;
                border-color: #3d434b;
            }
            
            .bot-message .message-content {
                background-color: #2d333b;
                color: #e1e4e8;
            }
            
            .typing-indicator {
                background-color: #2d333b;
            }
            
            #user-input {
                background-color: #2d333b;
                color: #e1e4e8;
                border-color: #3d434b;
            }
            
            .suggestion-chip {
                background-color: #2d333b;
                border-color: var(--primary-color);
                color: var(--primary-color);
            }
            
            .suggestion-chip:hover {
                background-color: #3d434b;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- è¨€èªé¸æŠç”»é¢ -->
        <div class="language-select-screen" id="language-select-screen">
            <h1>GOTO AI Support</h1>
            <p>ãŠå¥½ã¿ã®è¨€èªã‚’é¸æŠã—ã¦ä¼šè©±ã‚’å§‹ã‚ã¾ã—ã‚‡ã†</p>
            
            <div class="language-grid">
                <div class="language-card" data-lang="en">
                    <div class="flag">ğŸ‡ºğŸ‡¸</div>
                    <h3>English</h3>
                    <p>Start chatting in English</p>
                </div>
                
                <div class="language-card" data-lang="ja">
                    <div class="flag">ğŸ‡¯ğŸ‡µ</div>
                    <h3>æ—¥æœ¬èª</h3>
                    <p>æ—¥æœ¬èªã§ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹</p>
                </div>
                
                <div class="language-card" data-lang="ko">
                    <div class="flag">ğŸ‡°ğŸ‡·</div>
                    <h3>í•œêµ­ì–´</h3>
                    <p>í•œêµ­ì–´ë¡œ ì±„íŒ… ì‹œì‘</p>
                </div>
                
                <div class="language-card" data-lang="zh">
                    <div class="flag">ğŸ‡¨ğŸ‡³</div>
                    <h3>ä¸­æ–‡</h3>
                    <p>ç”¨ä¸­æ–‡å¼€å§‹èŠå¤©</p>
                </div>
            </div>
        </div>
        
        <!-- æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ç”»é¢ -->
        <div class="info-form-screen" id="info-form-screen">
            <h1 id="info-form-title">ç‰©ä»¶æƒ…å ±ã‚’å…¥åŠ›</h1>
            <p id="info-form-description">ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ãŸã‚ã«å¿…è¦ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
            
            <form class="info-form" id="property-form">
                <div class="form-group">
                    <label for="property-id" id="property-id-label">ç‰©ä»¶ID</label>
                    <input type="text" id="property-id" required>
                </div>
                
                <div class="form-group">
                    <label for="room-number" id="room-number-label">éƒ¨å±‹ç•ªå·</label>
                    <input type="text" id="room-number" required>
                </div>
                
                <div class="form-group">
                    <label for="issue-description" id="issue-label">ãŠå›°ã‚Šã®ã“ã¨</label>
                    <textarea id="issue-description" required></textarea>
                </div>
                
                <button type="submit" class="submit-btn" id="submit-info">é€ä¿¡</button>
            </form>
        </div>
        
        <!-- ãƒãƒ£ãƒƒãƒˆç”»é¢ -->
        <div class="chat-screen" id="chat-screen">
            <div class="chat-header">
                <h1>GOTO AI Support</h1>
                
                <div class="language-selector">
                    <button class="language-btn" data-lang="en">English</button>
                    <button class="language-btn" data-lang="ko">í•œêµ­ì–´</button>
                    <button class="language-btn" data-lang="ja">æ—¥æœ¬èª</button>
                    <button class="language-btn" data-lang="zh">ä¸­æ–‡</button>
                </div>
            </div>
            
            <div class="chat-container" id="chat-container">
                <div class="messages-container" id="messages-container">
                    <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã“ã“ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
                </div>
            </div>
            
            <div class="input-container">
                <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ææ¡ˆ -->
                <div class="message-suggestions" id="message-suggestions">
                    <!-- ææ¡ˆã¯JSã§å‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
                </div>
                
                <div class="input-field-container">
                    <input type="text" id="user-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..." aria-label="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›">
                    <button class="send-btn" id="send-button" aria-label="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä¿å­˜
        let sessionId = null;
        // ç¾åœ¨é¸æŠã•ã‚Œã¦ã„ã‚‹è¨€èª
        let currentLanguage = 'ja'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆåˆæœŸé¸æŠç”»é¢ã‹ã‚‰ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ï¼‰
        // ç‰©ä»¶æƒ…å ±ã‚’ä¿å­˜
        let propertyInfo = {
            propertyId: '',
            roomNumber: '',
            issue: ''
        };

        // DOMè¦ç´ 
        const languageSelectScreen = document.getElementById('language-select-screen');
        const infoFormScreen = document.getElementById('info-form-screen');
        const chatScreen = document.getElementById('chat-screen');
        const chatContainer = document.getElementById('chat-container');
        const messagesContainer = document.getElementById('messages-container');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const languageButtons = document.querySelectorAll('.language-btn');
        const languageCards = document.querySelectorAll('.language-card');
        const propertyForm = document.getElementById('property-form');
        const messageSuggestions = document.getElementById('message-suggestions');

        // ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ 
        const infoFormTitle = document.getElementById('info-form-title');
        const infoFormDescription = document.getElementById('info-form-description');
        const propertyIdLabel = document.getElementById('property-id-label');
        const roomNumberLabel = document.getElementById('room-number-label');
        const issueLabel = document.getElementById('issue-label');
        const submitInfoBtn = document.getElementById('submit-info');
        const propertyIdInput = document.getElementById('property-id');
        const roomNumberInput = document.getElementById('room-number');
        const issueInput = document.getElementById('issue-description');

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ææ¡ˆã®ãƒ‡ãƒ¼ã‚¿ï¼ˆè¨€èªã”ã¨ï¼‰
// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ææ¡ˆã®ãƒ‡ãƒ¼ã‚¿ï¼ˆè¨€èªã”ã¨ï¼‰
const suggestionsByLanguage = {
    'en': [
        'WiFi information',
        'How to use the air conditioner',
        'Nearest station',
        'No hot water',
        'Checkout procedure',
        'How to use washing machine',
        'Restaurant recommendations'
    ],
    'ja': [
        'WiFiæƒ…å ±ã‚’æ•™ãˆã¦',
        'ã‚¨ã‚¢ã‚³ãƒ³ã®ä½¿ã„æ–¹',
        'æœ€å¯„ã‚Šé§…ã¯',
        'ãŠæ¹¯ãŒå‡ºãªã„',
        'ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ‰‹ç¶šã',
        'æ´—æ¿¯æ©Ÿã®ä½¿ã„æ–¹',
        'ãŠã™ã™ã‚ã®é£²é£Ÿåº—'
    ],
    'ko': [
        'WiFi ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”',
        'ì—ì–´ì»¨ ì‚¬ìš© ë°©ë²•',
        'ê°€ì¥ ê°€ê¹Œìš´ ì—­ì€',
        'ëœ¨ê±°ìš´ ë¬¼ì´ ë‚˜ì˜¤ì§€ ì•Šì•„ìš”',
        'ì²´í¬ì•„ì›ƒ ì ˆì°¨',
        'ì„¸íƒê¸° ì‚¬ìš© ë°©ë²•',
        'ì¶”ì²œ ìŒì‹ì '
    ],
    'zh': [
        'WiFiä¿¡æ¯',
        'ç©ºè°ƒä½¿ç”¨æ–¹æ³•',
        'æœ€è¿‘çš„è½¦ç«™',
        'æ²¡æœ‰çƒ­æ°´',
        'é€€æˆ¿æ‰‹ç»­',
        'æ´—è¡£æœºä½¿ç”¨æ–¹æ³•',
        'æ¨èé¤å…'
    ]
};

        // ææ¡ˆãƒãƒƒãƒ—ã‚’æ›´æ–°
        function updateSuggestions(lang) {
            // æ—¢å­˜ã®ææ¡ˆã‚’ã‚¯ãƒªã‚¢
            messageSuggestions.innerHTML = '';
            
            // é¸æŠã•ã‚ŒãŸè¨€èªã®ææ¡ˆã‚’è¿½åŠ 
            const suggestions = suggestionsByLanguage[lang] || suggestionsByLanguage['en'];
            
            suggestions.forEach(suggestion => {
                const chip = document.createElement('div');
                chip.classList.add('suggestion-chip');
                chip.textContent = suggestion;
                chip.addEventListener('click', () => {
                    userInput.value = suggestion;
                    sendMessage();
                });
                messageSuggestions.appendChild(chip);
            });
        }
        // ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ 
const styleElement = document.createElement('style');
styleElement.textContent = `
    .suggestion-chip {
        background-color: white;
        border: 1px solid var(--primary-color);
        color: var(--primary-color);
        border-radius: 20px;
        padding: 8px 15px;
        font-size: 14px;
        cursor: pointer;
        transition: var(--transition);
        white-space: nowrap;
        max-width: 100%;
        overflow: hidden;
        text-overflow: ellipsis;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .suggestion-chip:hover {
        background-color: var(--primary-light);
        transform: translateY(-2px);
        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);
    }
    
    .suggestion-selected {
        background-color: var(--primary-color) !important;
        color: white !important;
        transform: scale(0.95) !important;
    }
    
    .message-suggestions {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 15px;
        padding-bottom: 5px;
    }
    
    @media (prefers-color-scheme: dark) {
        .suggestion-chip {
            background-color: #2d333b;
            border-color: var(--primary-color);
            color: var(--primary-color);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .suggestion-chip:hover {
            background-color: #3d434b;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        }
    }
`;

// ã‚¹ã‚¿ã‚¤ãƒ«è¦ç´ ã‚’headã«è¿½åŠ 
document.head.appendChild(styleElement);

        // è¨€èªé¸æŠã‚«ãƒ¼ãƒ‰åˆæœŸåŒ–
        languageCards.forEach(card => {
            card.addEventListener('click', () => {
                const selectedLang = card.dataset.lang;
                // è¨€èªã‚’è¨­å®šã—ã¦æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º
                setupInfoForm(selectedLang);
            });
        });

        // æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        // æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
function setupInfoForm(lang) {
    // è¨€èªã‚’è¨­å®š
    currentLanguage = lang;
    
    // è¨€èªãƒœã‚¿ãƒ³ã‚’æ›´æ–°
    updateLanguageButtons(lang);
    
    // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ©ãƒ™ãƒ«ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨€èªã«åˆã‚ã›ã¦è¨­å®š
    const formTexts = {
        'en': {
            title: 'Enter Property Information',
            description: 'Please provide the necessary information to receive support',
            propertyIdLabel: 'Property ID',
            roomNumberLabel: 'Room Number',
            issueLabel: 'Issue Description',
            submitBtn: 'Submit'
        },
        'ja': {
            title: 'ç‰©ä»¶æƒ…å ±ã‚’å…¥åŠ›',
            description: 'ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ãŸã‚ã«å¿…è¦ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
            propertyIdLabel: 'ç‰©ä»¶ID',
            roomNumberLabel: 'éƒ¨å±‹ç•ªå·',
            issueLabel: 'ãŠå›°ã‚Šã®ã“ã¨',
            submitBtn: 'é€ä¿¡'
        },
        'ko': {
            title: 'ë¬¼ê±´ ì •ë³´ ì…ë ¥',
            description: 'ì§€ì›ì„ ë°›ê¸° ìœ„í•´ í•„ìš”í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”',
            propertyIdLabel: 'ë¬¼ê±´ ID',
            roomNumberLabel: 'ë°© ë²ˆí˜¸',
            issueLabel: 'ë¬¸ì œ ì„¤ëª…',
            submitBtn: 'ì œì¶œ'
        },
        'zh': {
            title: 'è¾“å…¥ç‰©ä¸šä¿¡æ¯',
            description: 'è¯·æä¾›å¿…è¦ä¿¡æ¯ä»¥è·å–æ”¯æŒ',
            propertyIdLabel: 'ç‰©ä¸šID',
            roomNumberLabel: 'æˆ¿é—´å·',
            issueLabel: 'é—®é¢˜æè¿°',
            submitBtn: 'æäº¤'
        }
    };
    
    const texts = formTexts[lang] || formTexts['en'];
    
    infoFormTitle.textContent = texts.title;
    infoFormDescription.textContent = texts.description;
    propertyIdLabel.textContent = texts.propertyIdLabel;
    roomNumberLabel.textContent = texts.roomNumberLabel;
    issueLabel.textContent = texts.issueLabel;
    submitInfoBtn.textContent = texts.submitBtn;
    
    // è¡¨ç¤ºåˆ‡æ›¿
    languageSelectScreen.style.display = 'none';
    infoFormScreen.style.display = 'flex';
}

// ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
propertyForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // ãƒ•ã‚©ãƒ¼ãƒ ã®å€¤ã‚’å–å¾—ã—ã¦ä¿å­˜
    propertyInfo = {
        propertyId: propertyIdInput.value.trim(),
        roomNumber: roomNumberInput.value.trim(),
        issue: issueInput.value.trim()
    };
    
    // ãƒãƒ£ãƒƒãƒˆç”»é¢ã«ç§»å‹•
    startChat(currentLanguage);
    
    // ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆ
    propertyForm.reset();
});

// ãƒãƒ£ãƒƒãƒˆé–‹å§‹å‡¦ç†
function startChat(lang) {
    // è¨€èªã‚’è¨­å®š
    currentLanguage = lang;
    
    // è¨€èªãƒœã‚¿ãƒ³ã‚’æ›´æ–°
    updateLanguageButtons(lang);
    
    // è¨€èªã”ã¨ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
    const placeholders = {
        'en': 'Type a message...',
        'ko': 'ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...',
        'ja': 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...',
        'zh': 'è¾“å…¥æ¶ˆæ¯...'
    };
    
    userInput.placeholder = placeholders[lang] || placeholders['en'];
    
    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ææ¡ˆã‚’æ›´æ–°
    updateSuggestions(lang);
    
    // è¡¨ç¤ºåˆ‡æ›¿
    infoFormScreen.style.display = 'none';
    chatScreen.style.display = 'flex';
    
    // ç‰©ä»¶æƒ…å ±ã‹ã‚‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆ
    const promptTemplates = {
        'en': `This is a question about property ${propertyInfo.propertyId}, room ${propertyInfo.roomNumber}:\n\n${propertyInfo.issue}`,
        'ja': `${propertyInfo.propertyId}ã®${propertyInfo.roomNumber}ã«ã¤ã„ã¦ã®è³ªå•ã§ã™ã€‚\n\n${propertyInfo.issue}`,
        'ko': `${propertyInfo.propertyId}ì˜ ${propertyInfo.roomNumber}ì— ëŒ€í•œ ì§ˆë¬¸ì…ë‹ˆë‹¤.\n\n${propertyInfo.issue}`,
        'zh': `è¿™æ˜¯å…³äº${propertyInfo.propertyId}çš„${propertyInfo.roomNumber}çš„é—®é¢˜ã€‚\n\n${propertyInfo.issue}`
    };
    
    const prompt = promptTemplates[lang] || promptTemplates['en'];
    
    // ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    const welcomeMessages = {
        'en': 'Welcome to GOTO AI Support. We are processing your inquiry...',
        'ko': 'GOTO AI ì§€ì›ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤. ë¬¸ì˜ë¥¼ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...',
        'ja': 'GOTO AIã‚µãƒãƒ¼ãƒˆã¸ã‚ˆã†ã“ãã€‚ãŠå•ã„åˆã‚ã›ã‚’å‡¦ç†ã—ã¦ã„ã¾ã™...',
        'zh': 'æ¬¢è¿ä½¿ç”¨GOTO AIæ”¯æŒã€‚æˆ‘ä»¬æ­£åœ¨å¤„ç†æ‚¨çš„æŸ¥è¯¢...'
    };
    
    // ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    addMessage(welcomeMessages[lang] || welcomeMessages['en'], 'bot');
    
    // è‡ªå‹•ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡
    sendAutoMessage(prompt);
    
    // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
    userInput.focus();
}

// è¨€èªãƒœã‚¿ãƒ³ã‚’æ›´æ–°
function updateLanguageButtons(lang) {
    languageButtons.forEach(btn => {
        if (btn.dataset.lang === lang) {
            btn.classList.add('active');
        } else {
            btn.classList.remove('active');
        }
    });
}

// è¨€èªãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
languageButtons.forEach(btn => {
    btn.addEventListener('click', () => {
        const selectedLang = btn.dataset.lang;
        currentLanguage = selectedLang;
        updateLanguageButtons(selectedLang);
        updateSuggestions(selectedLang);
        
        // è¨€èªã”ã¨ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
        const placeholders = {
            'en': 'Type a message...',
            'ko': 'ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”...',
            'ja': 'ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...',
            'zh': 'è¾“å…¥æ¶ˆæ¯...'
        };
        
        userInput.placeholder = placeholders[selectedLang] || placeholders['en'];
    });
});

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
function addMessage(text, sender) {
    const messageDiv = document.createElement('div');
    messageDiv.classList.add('message');
    messageDiv.classList.add(sender === 'user' ? 'user-message' : 'bot-message');
    
    const avatar = document.createElement('div');
    avatar.classList.add('message-avatar');
    avatar.classList.add(sender === 'user' ? 'user-avatar' : 'bot-avatar');
    avatar.innerHTML = sender === 'user' ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';
    
    const content = document.createElement('div');
    content.classList.add('message-content');
    content.textContent = text;
    
    if (sender === 'user') {
        messageDiv.appendChild(content);
        messageDiv.appendChild(avatar);
    } else {
        messageDiv.appendChild(avatar);
        messageDiv.appendChild(content);
    }
    
    messagesContainer.appendChild(messageDiv);
    
    // è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    chatContainer.scrollTop = chatContainer.scrollHeight;
}

// ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’é€ä¿¡
function sendMessage() {
    const message = userInput.value.trim();
    if (message === '') return;
    
    // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
    addMessage(message, 'user');
    
    // å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
    userInput.value = '';
    
    // ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿è¡¨ç¤º
    showTypingIndicator();
    
    // å¿œç­”å‡¦ç†ï¼ˆã“ã“ã§ã¯ç°¡æ˜“çš„ã«å®Ÿè£…ï¼‰
    setTimeout(() => {
        removeTypingIndicator();
        
        // ã‚µãƒ³ãƒ—ãƒ«å¿œç­”
        const responses = {
            'en': {
                'WiFi information': 'The WiFi SSID is "GOTO-Guest" and the password is "welcome2023". You can find this information on the card in your room as well.',
                'How to use the air conditioner': 'The remote control for the air conditioner is on the wall. Press the power button and use the up/down arrows to set your desired temperature.',
                'Nearest station': 'The nearest station is Shinjuku Station, which is about a 7-minute walk from the property.',
                'No hot water': 'I\'m sorry to hear that. Please check if the hot water switch in the bathroom is turned on. If the problem persists, we will send maintenance staff.',
                'Checkout procedure': 'Checkout time is 11:00 AM. Please leave the key on the table and close the door when you leave.',
                'How to use washing machine': 'The washing machine is located on the 1st floor. Put in your laundry, add detergent, select a program using the dial, and press the start button.',
                'Restaurant recommendations': 'There are several great restaurants nearby. "Sushi Masa" for sushi, "Ramen Ichiban" for ramen, and "Sakura" for traditional Japanese cuisine are all within a 5-minute walk.'
            },
            'ja': {
                'WiFiæƒ…å ±ã‚’æ•™ãˆã¦': 'WiFiã®SSIDã¯ã€ŒGOTO-Guestã€ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ã€Œwelcome2023ã€ã§ã™ã€‚ã“ã®æƒ…å ±ã¯ãŠéƒ¨å±‹ã®ã‚«ãƒ¼ãƒ‰ã«ã‚‚è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚',
                'ã‚¨ã‚¢ã‚³ãƒ³ã®ä½¿ã„æ–¹': 'ã‚¨ã‚¢ã‚³ãƒ³ã®ãƒªãƒ¢ã‚³ãƒ³ã¯å£ã«å–ã‚Šä»˜ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚é›»æºãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€ä¸Šä¸‹ã®çŸ¢å°ã§å¸Œæœ›ã®æ¸©åº¦ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚',
                'æœ€å¯„ã‚Šé§…ã¯': 'æœ€å¯„ã‚Šé§…ã¯æ–°å®¿é§…ã§ã€ç‰©ä»¶ã‹ã‚‰å¾’æ­©ç´„7åˆ†ã§ã™ã€‚',
                'ãŠæ¹¯ãŒå‡ºãªã„': 'ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚æµ´å®¤ã®çµ¦æ¹¯ã‚¹ã‚¤ãƒƒãƒãŒã‚ªãƒ³ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚å•é¡ŒãŒè§£æ±ºã—ãªã„å ´åˆã¯ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¹ã‚¿ãƒƒãƒ•ã‚’æ´¾é£ã—ã¾ã™ã€‚',
                'ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ‰‹ç¶šã': 'ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆæ™‚é–“ã¯åˆå‰11æ™‚ã§ã™ã€‚éµã¯ãƒ†ãƒ¼ãƒ–ãƒ«ã«ç½®ã„ã¦ã€å‡ºã‚‹éš›ã«ãƒ‰ã‚¢ã‚’é–‰ã‚ã¦ãã ã•ã„ã€‚',
                'æ´—æ¿¯æ©Ÿã®ä½¿ã„æ–¹': 'æ´—æ¿¯æ©Ÿã¯1éšã«ã‚ã‚Šã¾ã™ã€‚æ´—æ¿¯ç‰©ã‚’å…¥ã‚Œã€æ´—å‰¤ã‚’è¿½åŠ ã—ã€ãƒ€ã‚¤ãƒ¤ãƒ«ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’é¸æŠã—ã€ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚',
                'ãŠã™ã™ã‚ã®é£²é£Ÿåº—': 'è¿‘ãã«ã¯ç´ æ™´ã‚‰ã—ã„ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã™ã€‚å¯¿å¸ãªã‚‰ã€Œå¯¿å¸æ”¿ã€ã€ãƒ©ãƒ¼ãƒ¡ãƒ³ãªã‚‰ã€Œãƒ©ãƒ¼ãƒ¡ãƒ³ä¸€ç•ªã€ã€æ—¥æœ¬æ–™ç†ãªã‚‰ã€Œã•ãã‚‰ã€ãŒã™ã¹ã¦å¾’æ­©5åˆ†ä»¥å†…ã«ã‚ã‚Šã¾ã™ã€‚'
            },
            'ko': {
                'WiFi ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì„¸ìš”': 'WiFi SSIDëŠ” "GOTO-Guest"ì´ê³  ë¹„ë°€ë²ˆí˜¸ëŠ” "welcome2023"ì…ë‹ˆë‹¤. ì´ ì •ë³´ëŠ” ê°ì‹¤ì˜ ì¹´ë“œì—ì„œë„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                'ì—ì–´ì»¨ ì‚¬ìš© ë°©ë²•': 'ì—ì–´ì»¨ ë¦¬ëª¨ì»¨ì€ ë²½ì— ìˆìŠµë‹ˆë‹¤. ì „ì› ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ìœ„/ì•„ë˜ í™”ì‚´í‘œë¥¼ ì‚¬ìš©í•˜ì—¬ ì›í•˜ëŠ” ì˜¨ë„ë¥¼ ì„¤ì •í•˜ì„¸ìš”.',
                'ê°€ì¥ ê°€ê¹Œìš´ ì—­ì€': 'ê°€ì¥ ê°€ê¹Œìš´ ì—­ì€ ì‹ ì£¼ì¿ ì—­ìœ¼ë¡œ, ìˆ™ì†Œì—ì„œ ë„ë³´ë¡œ ì•½ 7ë¶„ ê±°ë¦¬ì— ìˆìŠµë‹ˆë‹¤.',
                'ëœ¨ê±°ìš´ ë¬¼ì´ ë‚˜ì˜¤ì§€ ì•Šì•„ìš”': 'ë¶ˆí¸ì„ ë“œë ¤ ì£„ì†¡í•©ë‹ˆë‹¤. ìš•ì‹¤ì˜ ì˜¨ìˆ˜ ìŠ¤ìœ„ì¹˜ê°€ ì¼œì ¸ ìˆëŠ”ì§€ í™•ì¸í•´ ì£¼ì„¸ìš”. ë¬¸ì œê°€ ì§€ì†ë˜ë©´ ìœ ì§€ë³´ìˆ˜ ì§ì›ì„ ë³´ë‚´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.',
                'ì²´í¬ì•„ì›ƒ ì ˆì°¨': 'ì²´í¬ì•„ì›ƒ ì‹œê°„ì€ ì˜¤ì „ 11ì‹œì…ë‹ˆë‹¤. ë– ë‚  ë•Œ í…Œì´ë¸”ì— ì—´ì‡ ë¥¼ ë‘ê³  ë¬¸ì„ ë‹«ì•„ì£¼ì„¸ìš”.',
                'ì„¸íƒê¸° ì‚¬ìš© ë°©ë²•': 'ì„¸íƒê¸°ëŠ” 1ì¸µì— ìˆìŠµë‹ˆë‹¤. ì„¸íƒë¬¼ì„ ë„£ê³ , ì„¸ì œë¥¼ ì¶”ê°€í•˜ê³ , ë‹¤ì´ì–¼ë¡œ í”„ë¡œê·¸ë¨ì„ ì„ íƒí•œ ë‹¤ìŒ ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.',
                'ì¶”ì²œ ìŒì‹ì ': 'ê·¼ì²˜ì— ëª‡ ê°œì˜ í›Œë¥­í•œ ë ˆìŠ¤í† ë‘ì´ ìˆìŠµë‹ˆë‹¤. ìŠ¤ì‹œëŠ” "ìŠ¤ì‹œ ë§ˆì‚¬", ë¼ë©˜ì€ "ë¼ë©˜ ì´ì¹˜ë°˜", ì „í†µ ì¼ì‹ì€ "ì‚¬ì¿ ë¼"ê°€ ëª¨ë‘ ë„ë³´ 5ë¶„ ì´ë‚´ì— ìˆìŠµë‹ˆë‹¤.'
            },
            'zh': {
                'WiFiä¿¡æ¯': 'WiFi SSIDæ˜¯"GOTO-Guest"ï¼Œå¯†ç æ˜¯"welcome2023"ã€‚æ‚¨ä¹Ÿå¯ä»¥åœ¨æˆ¿é—´å†…çš„å¡ç‰‡ä¸Šæ‰¾åˆ°æ­¤ä¿¡æ¯ã€‚',
                'ç©ºè°ƒä½¿ç”¨æ–¹æ³•': 'ç©ºè°ƒé¥æ§å™¨åœ¨å¢™ä¸Šã€‚æŒ‰ä¸‹ç”µæºæŒ‰é’®ï¼Œä½¿ç”¨ä¸Š/ä¸‹ç®­å¤´è®¾ç½®æ‚¨æƒ³è¦çš„æ¸©åº¦ã€‚',
                'æœ€è¿‘çš„è½¦ç«™': 'æœ€è¿‘çš„è½¦ç«™æ˜¯æ–°å®¿ç«™ï¼Œè·ç¦»ç‰©ä¸šæ­¥è¡Œçº¦7åˆ†é’Ÿã€‚',
                'æ²¡æœ‰çƒ­æ°´': 'å¾ˆæŠ±æ­‰å¬åˆ°è¿™ä¸ªé—®é¢˜ã€‚è¯·æ£€æŸ¥æµ´å®¤ä¸­çš„çƒ­æ°´å¼€å…³æ˜¯å¦å·²æ‰“å¼€ã€‚å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œæˆ‘ä»¬å°†æ´¾ç»´ä¿®äººå‘˜å‰æ¥ã€‚',
                'é€€æˆ¿æ‰‹ç»­': 'é€€æˆ¿æ—¶é—´æ˜¯ä¸Šåˆ11ç‚¹ã€‚ç¦»å¼€æ—¶è¯·å°†é’¥åŒ™æ”¾åœ¨æ¡Œå­ä¸Šå¹¶å…³ä¸Šé—¨ã€‚',
                'æ´—è¡£æœºä½¿ç”¨æ–¹æ³•': 'æ´—è¡£æœºä½äºä¸€æ¥¼ã€‚æ”¾å…¥æ‚¨çš„è¡£ç‰©ï¼Œæ·»åŠ æ´—æ¶¤å‰‚ï¼Œä½¿ç”¨è½¬ç›˜é€‰æ‹©ç¨‹åºï¼Œç„¶åæŒ‰ä¸‹å¼€å§‹æŒ‰é’®ã€‚',
                'æ¨èé¤å…': 'é™„è¿‘æœ‰å‡ å®¶å¾ˆæ£’çš„é¤å…ã€‚å¯¿å¸æœ‰"å¯¿å¸é›…"ï¼Œæ‹‰é¢æœ‰"æ‹‰é¢ä¸€ç•ª"ï¼Œä¼ ç»Ÿæ—¥æœ¬æ–™ç†æœ‰"æ¨±èŠ±"ï¼Œéƒ½åœ¨æ­¥è¡Œ5åˆ†é’Ÿå†…ã€‚'
            }
        };
        
        // ä¸€è‡´ã™ã‚‹å¿œç­”ãŒã‚ã‚Œã°ä½¿ç”¨ã€ãªã‘ã‚Œã°ä¸€èˆ¬çš„ãªå¿œç­”
        const langResponses = responses[currentLanguage] || responses['en'];
        
        // å®Œå…¨ä¸€è‡´ã™ã‚‹ã‹ç¢ºèª
        if (langResponses[message]) {
            addMessage(langResponses[message], 'bot');
        } else {
            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ³ã‚°ï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰
            let matched = false;
            for (const [key, response] of Object.entries(langResponses)) {
                if (message.toLowerCase().includes(key.toLowerCase())) {
                    addMessage(response, 'bot');
                    matched = true;
                    break;
                }
            }
            
            // ä¸€è‡´ã™ã‚‹ã‚‚ã®ãŒãªã‘ã‚Œã°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            if (!matched) {
                const defaultMessages = {
                    'en': 'Thank you for your message. I\'ll help you with that. Could you please provide more details?',
                    'ja': 'ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ãŠæ‰‹ä¼ã„ã„ãŸã—ã¾ã™ã€‚è©³ç´°ã‚’ãŠçŸ¥ã‚‰ã›ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ',
                    'ko': 'ë©”ì‹œì§€ ê°ì‚¬í•©ë‹ˆë‹¤. ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë” ìì„¸í•œ ì •ë³´ë¥¼ ì œê³µí•´ ì£¼ì‹œê² ì–´ìš”?',
                    'zh': 'æ„Ÿè°¢æ‚¨çš„ç•™è¨€ã€‚æˆ‘ä¼šå¸®åŠ©æ‚¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ‚¨èƒ½æä¾›æ›´å¤šè¯¦ç»†ä¿¡æ¯å—ï¼Ÿ'
                };
                
                addMessage(defaultMessages[currentLanguage] || defaultMessages['en'], 'bot');
            }
        }
        
        // æ–°ã—ã„ææ¡ˆã‚’è¡¨ç¤ºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        // updateSuggestions(currentLanguage);
    }, 1500);
}

// è‡ªå‹•ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ï¼ˆåˆæœŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”¨ï¼‰
function sendAutoMessage(message) {
    // ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿è¡¨ç¤º
    showTypingIndicator();
    
    // å¿œç­”å‡¦ç†
    setTimeout(() => {
        removeTypingIndicator();
        
        // è¨€èªã«å¿œã˜ãŸå¿œç­”
        const welcomeResponses = {
            'en': `Thank you for providing information about property ${propertyInfo.propertyId}, room ${propertyInfo.roomNumber}. How can I assist you with your concern today?`,
            'ja': `${propertyInfo.propertyId}ã®${propertyInfo.roomNumber}ã«é–¢ã™ã‚‹æƒ…å ±ã‚’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚æœ¬æ—¥ã¯ã©ã®ã‚ˆã†ã«ãŠæ‰‹ä¼ã„ã§ãã¾ã™ã‹ï¼Ÿ`,
            'ko': `${propertyInfo.propertyId}ì˜ ${propertyInfo.roomNumber}ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•´ ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì˜¤ëŠ˜ ì–´ë–»ê²Œ ë„ì™€ë“œë¦´ê¹Œìš”?`,
            'zh': `æ„Ÿè°¢æ‚¨æä¾›å…³äº${propertyInfo.propertyId}çš„${propertyInfo.roomNumber}çš„ä¿¡æ¯ã€‚ä»Šå¤©æˆ‘èƒ½å¦‚ä½•å¸®åŠ©æ‚¨è§£å†³é—®é¢˜ï¼Ÿ`
        };
        
        addMessage(welcomeResponses[currentLanguage] || welcomeResponses['en'], 'bot');
    }, 2000);
}

// ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã‚’è¡¨ç¤º
function showTypingIndicator() {
    const typingDiv = document.createElement('div');
    typingDiv.classList.add('message', 'bot-message');
    typingDiv.id = 'typing-indicator';
    
    const avatar = document.createElement('div');
    avatar.classList.add('message-avatar', 'bot-avatar');
    avatar.innerHTML = '<i class="fas fa-robot"></i>';
    
    const typingIndicator = document.createElement('div');
    typingIndicator.classList.add('typing-indicator');
    typingIndicator.innerHTML = '<span></span><span></span><span></span>';
    
    typingDiv.appendChild(avatar);
    typingDiv.appendChild(typingIndicator);
    
    messagesContainer.appendChild(typingDiv);
    
    // è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    chatContainer.scrollTop = chatContainer.scrollHeight;
}

// ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ã‚’å‰Šé™¤
function removeTypingIndicator() {
    const typingIndicator = document.getElementById('typing-indicator');
    if (typingIndicator) {
        typingIndicator.remove();
    }
}

// é€ä¿¡ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
sendButton.addEventListener('click', sendMessage);

// ã‚¨ãƒ³ã‚¿ãƒ¼ã‚­ãƒ¼ã®å‡¦ç†
userInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        e.preventDefault();
        sendMessage();
    }
});

// åˆæœŸè¡¨ç¤ºã¯è¨€èªé¸æŠç”»é¢
languageSelectScreen.style.display = 'flex';
infoFormScreen.style.display = 'none';
chatScreen.style.display = 'none';
            
            // ç‰©ä»¶æƒ…å ±ã‹ã‚‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç”Ÿæˆ
            const promptTemplates = {
                'en': `This is a question about property ${propertyInfo.propertyId}, room ${propertyInfo.roomNumber}:\n\n${propertyInfo.issue}`,
                'ja': `${propertyInfo.propertyId}ã®${propertyInfo.roomNumber}ã«ã¤ã„ã¦ã®è³ªå•ã§ã™ã€‚\n\n${propertyInfo.issue}`,
                'ko': `${propertyInfo.propertyId}ì˜ ${propertyInfo.roomNumber}ì— ëŒ€í•œ ì§ˆë¬¸ì…ë‹ˆë‹¤.\n\n${propertyInfo.issue}`,
                'zh': `è¿™æ˜¯å…³äº${propertyInfo.propertyId}çš„${propertyInfo.roomNumber}çš„é—®é¢˜ã€‚\n\n${propertyInfo.issue}`
            };
            
            const prompt = promptTemplates[lang] || promptTemplates['en'];
            
            // ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            const welcomeMessages = {
                'en': 'Welcome to GOTO AI Support. We are processing your inquiry...',
                'ko': 'GOTO AI ì§€ì›ì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤. ë¬¸ì˜ë¥¼ ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤...',
                'ja': 'GOTO AIã‚µãƒãƒ¼ãƒˆã¸ã‚ˆã†ã“ãã€‚ãŠå•ã„åˆã‚ã›ã‚’å‡¦ç†ã—ã¦ã„ã¾ã™...',
                'zh': 'æ¬¢è¿ä½¿ç”¨GOTO AIæ”¯æŒã€‚æˆ‘ä»¬æ­£åœ¨å¤„ç†æ‚¨çš„æŸ¥è¯¢...'
            };
            
            // ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            addMessage(welcomeMessages[lang] || welcomeMessages['en'], 'bot');
            
            // è‡ªå‹•ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é€ä¿¡
            sendAutoMessage(prompt);
            
            // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            userInput.focus();
        }
        
        // è¨€èªãƒœã‚¿ãƒ³ã‚’æ›´æ–°
        function updateLanguageButtons(lang) {
            languageButtons.forEach(btn => {
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active'
